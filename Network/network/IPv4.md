#IPv4
>Author: 백승화  
>Created: 2021년 10월 7일  
>Tags: `IP`

## IPv4 헤더 구조
![ipv4](../image/ipv4.png)

- 버전 : IPv6인지 IPv4인지 입력하는 공간이다
- 헤더길이 : 헤더길이 + 옵션을 포함한 값이다
- 서비스 타입 : 다른 유형의 IP 데이터그램을 구분하는데 사용
- 데이터그램 길이 : 전체 데이터그램 길이이다 헤더 + 데이터
- 인식자, 플래그, 오프셋 : 단편화에 필요한 헤더들이다
- TTL : 네트워크에서 무한히 존재하지 않도록 하나의 홉을 지날때마다 수명이 줄어들어서 0이되면 사라진다
- 프로토콜 : 상위계층에 뭘 사용했는지

## 단편화 (fragment)
MTU(Maximum Transmission Unit)이 각 링크 계층마다 존재하는데  
네트워크 계층에서 만들어진 데이터그램은 MTU의 크기를 넘어서 링크 계층으로 전달하지 못한다  
그러므로 데이터그램을 전달 할 수 있는 크기로 나누는것을 단편화라고 한다  

### 단편화의 필수요소
- `식별번호` : 네트워크 계층에서 데이터그램을 내보낼때마다 식별번호의 값을 증가시킨다  
    같은 식별번호를 가지면 해당 데이터그램은 같은 데이터그램이라는 것을 파악할 수 있다
- `플래그` : 단편화를 하게되면 어디가 마지막 패킷인지를 알아야하기 때문에 마지막 패킷은 0을 가지고 나머지는 1을 가진다  

- `단편화 오프셋` : 단편화를 하게되면 순서를 맞춰야하기 때문에 오프셋을 가지고 위치를 찾을 수 있게 해준다  

### 재결합의 위치
네트워크 계층에서 단편화가 이루어지지만 그렇다고 모든 네트워크 라우터에서 재결합을 하면 성능의 문제가 생김으로  
종단 시스템에서 재결합하기로 했다  

