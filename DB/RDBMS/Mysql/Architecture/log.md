# Log
>Author: 백승화  
>Created: 2021년 9월 29일  
>Tags: `undo`, `redo`

## Undo Log
`용도` : 트랜잭션과 격리 수준을 보장하기 위해서 DML(Insert, Update, Delete)로 변경되기 이전 버전의 데이터를 별도로 백업하는 것을 이야기한다 

- 장점
    - `트랜잭션 보장` : 롤백된 경우 undo log에서 데이터를 가져와서 복구한다
    - `격리 수준 보장` : 특정 커넥션에서 데이터를 변경하는 도중에 다른 커넥션에서 데이터를 읽을려고 한다면 undo log에서 읽는다
    
- 단점
    - `저장공간 부족 현상` : 트랜잭션을 실수로 종료되지 않은 경우 해당 트랜잭션에 관련된 데이터들은 계속해서 undo log에 기록된다
    - `쿼리 느련지는 현상` : undo 영역이 늘어나면 그만큼 탐색 시간도 오래걸리게된다

## Redo Log
`용도` : 서버가 비정상적으로 종료되었을 때 데이터 파일에 기록하지 못한 데이터를 잃지 않게 해주는 용도이다  
redo log 같은 경우에는 쓰는 즉시 디스크에 기록이 된다

대부분의 데이터베이스 서버는 데이터 변경 내용을 로그로 먼저 기록한다  
`이유` : db에서 디스크에 쓰기는 랜덤 I/O가 발생하기 때문에 비용이 크다 그러므로 로그에 기록을 한다  


**서버가 비정상적으로 종료되는 경우 발생할 수 있는 데이터 비일관성**
1. 커밋됐지만 데이터 파일에 기록되지 않은 데이터
2. 롤백됐지만 데이터 파일에 이미 기록된 데이터  

**해결방법**  
1번 : redo log에 저장된 데이터를 데이터 파일에 복사하기만 하면된다  
2번 : undo log에 기록된 데이터를 사용해서 해결하면 된다
